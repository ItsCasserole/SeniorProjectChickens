<!DOCTYPE html>
<head>
    <link href="https://www.w3schools.com/w3css/4/w3.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
</head>

<body>
    <div class="w3-sidebar w3-brown w3-bar-block" style="width:15%">
        <h4 class="w3-bar-item">Navigation</h4>
        <a class="w3-bar-item w3-button w3-disabled" href="#">
        <i class="material-icons">home</i>  Home</a>
        <a class="w3-bar-item w3-button" href="#"><i class="material-icons">person</i>  Flock Manager</a>
    </div>

    <div class="w3-container w3-brown" style="margin-left:15%">
        <h1>Flock Manager</h1>
    </div>

    <div style="margin-left:16%">
	    <div class="w3-card w3-padding-16 w3-margin-bottom" style="width:75%">
		    <div class="w3-container w3-khaki">
			    <h3>Messages</h3>
		    </div>
		<div class="w3-container w3-border w3-margin">
		    <div class="w3-container w3-border">
			    <label class = "w3-text-black">Example Sender 1</label>	<!--sender from DB-->
			    <label class = "w3-text-grey">(00:00:00)</label>	<!--timestamp from DB-->
			    <label class = "w3-text-black">:</label>
			    <label class = "w3-text-black">This is an example message.</label>	<!--message from DB-->
		    </div>
		    <div class="w3-container w3-border">
			    <label class = "w3-text-black">Example Sender 2</label>
			    <label class = "w3-text-grey">(00:01:00)</label>
			    <label class = "w3-text-black">:</label>
			    <label class = "w3-text-black">IMPORTANT: This is another example of a message.<label>
		    </div>
		</div>
	    </div>
	    
	    <div class="w3-card w3-padding-16 w3-margin-bottom" style="width:75%">
                        <div class = "w3-container w3-khaki">
                                <h3>Available Farms</h3>
                        </div>

                        <div class = "w3-dropdown-hover w3-padding-16 w3-margin"> 
                        	<select id="farmList" action="get_all_farms.php" onclick="doSomething();" onchange="showSelect(this.value)">
				</select>
                        </div>
			
                        <form class="w3-container w3-padding-16">
                		<label class="w3-text-black"><b>Enter Farm Name:</b></label>
                		<input id="farmInfo" class="w3-input w3-border w3-light-grey" type="text">        
			</form>
			
			<div class = "w3-container w3-padding-16">
				<button id="getInfo" name="getInfo" onclick="searchFarm();" class="w3-btn w3-brown w3-medium">SEARCH</button>
				<button id="allInfo" name="allInfo" onclick="showAll();" class="w3-btn w3-brown w3-medium">SHOW ALL FARMS</button>
			</div>
			
                        <label class = "w3-text-black">Farm Information:</label>
                        <br>
			<div id="nameInfo"><b></b></div>
                        
	    </div>
		
	<div class="w3-card w3-padding-16 w3-margin-bottom" style="width:75%">
        	<div class="w3-container w3-khaki">
            		<h3>Add New Farm</h3>
 	</div>

        	<form class="w3-container w3-padding-16">

            	<label class="w3-text-black"><b>Farm Name</b></label>
            	<input id = "farmName" class="w3-input w3-border w3-light-grey" type="text">

           	<label class="w3-text-black"><b>Street Address</b> (optional)</label>
            	<input id= "farmAddress" class="w3-input w3-border w3-light-grey" type="text">
            	
		<label class="w3-text-black"><b>City</b></label>
            	<input id = "farmCity" class="w3-input w3-border w3-light-grey" type="text">

            <button  id ="save" name="save" onclick="addFarm();" class="w3-btn w3-brown w3-medium">SAVE</button>
            <button id="cancel" onclick="clearAddFarm();" class="w3-btn w3-brown w3-medium">CANCEL</button>
	        </form>
	</div>    

    </div> 
    </body>
<script language = "javascript">
//functions for adding new farm. 

function addFarm(){
    var farm_name = $('#farmName').val();
    var farm_address = $('#farmAddress').val();
    var farm_city = $('#farmCity').val();
   
    if(farm_name == "" ||  farm_city == "")
    {   
        alert("Please enter both, Farm Name and Farm City");
    }
    else
    {   
   
        $.ajax({
            type: "POST",
            url: "insert_new_farm.php", //php file goes here
            data:{
                farm_name : farm_name,
                farm_address : farm_address,
                farm_city : farm_city,
            },
            success: function(response){
                alert(response);
            }
        })
    }
}

//function for searching info associated to farm
function searchFarm(){
	var farm_name = $('#farmInfo').val();

	  

	$.ajax({
		type: "GET",
		url: "search.php",
		data: {
		   farm_name : farm_name
		},
		success: function(response){	
			$('#nameInfo').html(response);
		}
	   });
	
}
//function to show all farms
function showAll(){
	
	$.ajax({
		type: "GET",
		url: "show_all_info.php",
		data: {},
		success: function(response){
			$('#nameInfo').html(response);
		}
	});
}

//function for geting list of farms.
function doSomething () {
	$.ajax({
	    type: "GET",
	    url: "get_all_farms.php",
	    data: {},
	    success: function(response){
	        //alert(response);
		$('#farmList').html(response);
            }
	});
}

//function for showing info from farm selected from list
function showSelect(str) {
    if (str == "") {
        document.getElementById("farmName").innerHTML = "";
        return;
    } else {
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("nameInfo").innerHTML = this.responseText;
            }
        };
        xmlhttp.open("GET","show_farm_info.php?farm_id="+str,true);
        xmlhttp.send();
    }
}


//function for reseting the farm values.
function clearAddFarm(){
       document.getElementById("cancel").reset();
}

//function for editing the farm values.
function editFarm(){
alert("Can not edit farm")
}
        </script>
</html>

