<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>

    <title>Simply Fowl | Dispatch Page</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Font Awesome JS -->
    <script src="https://kit.fontawesome.com/412b07d0f6.js" crossorigin="anonymous"></script>

	<!-- Needed for bootstrap -->
	<!-- Popper.JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
	<!-- Bootstrap JS -->
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

    <!-- Cookies -->
    <script src = "docCookies.js"></script>
    <script src = "script.js"></script>
</head>

<body onload="startup()">
<div class="wrapper">

    <!-- Sidebar  -->
    <div>
        <nav id="sidebar" class="fixed dispatch">
            <div class="sidebar-header"><h3 class="text-center">Simply Fowl</h3></div>

            <ul class="list-unstyled components">
                <li><a href="saleshomepage.html"><i class="fas fa-home fa-fw"></i> Home</a></li>
                <li><a href="order.html"><i class="fas fa-box-open fa-fw"></i> Orders</a></li>
                <li class="active"><a><i class="fas fa-truck fa-fw"></i> Dispatch</a></li>
                <li><a href="shipping.html"><i class="fas fa-briefcase fa-fw"></i> Shipments</a></li>
                <li><a href="maintenance.html"><i class="fas fa-wrench fa-fw"></i> Maintenance</a></li>
                <li id="adminsub">
                    <a href="#adminSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                        <i class="fas fa-user-cog fa-fw"></i> Admin</a>
                    <ul class="collapse list-unstyled" id="adminSubmenu">
                        <li><a href="flockPage.html">View Flock Info</a></li>
                        <li><a href="accountsmanagement.html">Manage Accounts</a></li>
                    </ul>
                </li>
            </ul>

        </nav>
    </div>


    <!-- Page Content  -->
    <div id="content" >
        <!-- Page Header Navbar -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <button type="button" id="sidebarCollapse" class="btn"><i class="fas fa-bars"></i></button>
                <h4 class="nav navbar-nav navbar-center">Dispatches</h4>
                <ul class="nav navbar-nav navbar-right">
                        <li><button type="button" class="btn btn-primary" onclick="logout()">Log Out</button></li>
                </ul>
            </div>
        </nav>

        <!-- Individual Page Content Goes Here -->

        <!-- Create New Dispatch Card -->
        <div class="card mx-auto">
            <div class="card-header">
                <h4 class="card-title">Create New Dispatch</h4>
            </div>
            <div class="card-body">

                <form>
                    <div class="form-row">
                        <div class="form-group col-md-4">
                            <label for="truck">Truck</label>
                            <select id="truck" class="form-control selectpicker ">
                                <option value="-1">Choose Truck...</option>
                            </select>
                        </div>
                        <div class="form-group col-md-4">
                            <label for="driver">Driver</label>
                            <select id="driver" class="form-control selectpicker">
                                <option value="-1">Choose Driver...</option>

                            </select>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="createDispatch()">Create</button>
                </form>
            </div>
        </div>
        <br>
    </div>
</body>
<script type="text/javascript">
    function startup(){
	loggedin();
	checkPermissions("Sales Manager");

	populateTruckDropdown("MANUAL");
	populateDriverDropdown("AUTOMATIC");
	
    }

    function populateTruckDropdown(transmission){
	$.ajax({
	    type: 'post',
	    url: '../truck/getTomorrowsAvailableTrucks.php',
	    data: {transmission: transmission},
	    success: function(result){
		//truck_id, truck_max_coops, truck_number
		for(var i=0; i<result.length; i++){
		    var str = '<option value"' + result[i].truck_id;
		    str += '">' + result[i].truck_number + "</option>";
		    $('#truck').append(str);
		}
		$('#truck').selectpicker('refresh');
	    }
	});
    }

    function populateDriverDropdown(transmission){
	$.ajax({
	    type: 'post',
	    url: '../driver/getTomorrowsAvailableDrivers.php',
	    data: {transmission: transmission},
	    success: function(result){
		for(var i=0; i<result.length; i++){
		    var str = '<option value"' + result[i].driver_id;
		    str += '">' + result[i].last_name + ", " + result[i].first_name;
		    str += "</option>";
		    $('#driver').append(str);
		}
		$('#driver').selectpicker('refresh');
	    }
	});
    }
</script>
</html>
